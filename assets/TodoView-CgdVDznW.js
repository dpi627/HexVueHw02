import{r as u,d as x,c as v,a as t,w as r,e as p,t as s,v as d,F as C,g as m,o as k}from"./index-cIAim-Ui.js";const M={key:0},R={key:1},g="https://todolist-api.hexschool.io/",I={__name:"TodoView",setup(S){const V=u("Todo"),y=u(""),c=u(""),w=u(""),n=u({email:"",password:"",nickname:""}),$=async()=>{try{let l=`${g}users/sign_up`;const e=await m.post(l,n.value);console.log(e),y.value=e.data}catch(l){console.error(l)}},a=u({email:"",password:""}),f=async()=>{try{let l=`${g}users/sign_in`;const e=await m.post(l,a.value);console.log(e),c.value=e.data,document.cookie=`my-token=${e.data.token}; path=/`}catch(l){console.error(l)}},i=u({status:!1,uid:"",nickname:""}),U=async()=>{const l=document.cookie.replace(/(?:^|.*;\s*)my-token\s*=\s*([^;]*).*$/i,"$1");console.log("Token:",l);let e=`${g}users/checkout`;try{const o=await m.get(e,{headers:{Authorization:l}});w.value=o,i.value=o.data}catch(o){console.log(o),i.value.status=!1}},b=()=>{let l=Math.random().toString(36).substring(2,8);n.value.email=`${l}@gmail.com`,n.value.password=l,n.value.nickname=l,a.value.email=n.value.email,a.value.password=n.value.password};return x(()=>{b()}),x(async()=>{await U()}),(l,e)=>(k(),v(C,null,[t("h1",null,s(V.value),1),e[5]||(e[5]=t("h2",null,"Sign Up",-1)),r(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>n.value.email=o)},null,512),[[d,n.value.email]]),r(t("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=o=>n.value.password=o)},null,512),[[d,n.value.password]]),r(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=o=>n.value.nickname=o)},null,512),[[d,n.value.nickname]]),t("button",{type:"button",onClick:$},"Sign Up"),t("button",{type:"button",onClick:b},"Random"),e[6]||(e[6]=t("hr",null,null,-1)),p(" "+s(n.value)+" ",1),e[7]||(e[7]=t("hr",null,null,-1)),p(" "+s(y.value)+" ",1),e[8]||(e[8]=t("h2",null,"Sign In",-1)),r(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>a.value.email=o)},null,512),[[d,a.value.email]]),r(t("input",{type:"password","onUpdate:modelValue":e[4]||(e[4]=o=>a.value.password=o)},null,512),[[d,a.value.password]]),t("button",{type:"button",onClick:f},"Sign In"),e[9]||(e[9]=t("hr",null,null,-1)),p(" "+s(a.value)+" ",1),e[10]||(e[10]=t("hr",null,null,-1)),p(" "+s(c.value)+" ",1),e[11]||(e[11]=t("h2",null,"Checkout",-1)),t("button",{type:"button",onClick:U},"Checkout"),i.value.status?(k(),v("div",M," 已登入 "+s(i.value.nickname)+" ("+s(i.value.uid)+") ",1)):(k(),v("div",R," 未登入 ")),e[12]||(e[12]=t("hr",null,null,-1)),p(" "+s(i.value)+" "+s(w.value),1)],64))}};export{I as default};
